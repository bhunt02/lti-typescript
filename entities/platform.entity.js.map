{"version":3,"file":"platform.entity.js","sourceRoot":"/","sources":["entities/platform.entity.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,qCAAgG;AAChG,0CAAmE;AACnE,+DAAuD;AACvD,uDAA+C;AAC/C,6CAA6D;AAKtD,IAAM,aAAa,GAAnB,MAAM,aAAc,SAAQ,oBAAU;IA4B3C,SAAS;QACP,OAAO;YACL,MAAM,EAAE,IAAI,CAAC,eAAe;YAC5B,GAAG,EAAE,IAAI,CAAC,YAAY;SACvB,CAAC;IACJ,CAAC;CAsBF,CAAA;AAvDY,sCAAa;AAExB;IADC,IAAA,uBAAa,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;;0CACpB;AAGZ;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;;kDACL;AAGpB;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;;+CACR;AAGjB;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;;2CACZ;AAGb;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;;6DACM;AAG/B;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;;0DACG;AAG5B;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;0DACZ;AAG7B;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE,2BAAmB,EAAE,OAAO,EAAE,SAAS,EAAE,CAAC;;sDACnC;AAGrC;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,CAAC;;mDACJ;AAUrB;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC;;6CAC5B;AAGhB;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC;;4DACb;AAG/B;IADC,IAAA,gBAAM,EAAC,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC;;2DACX;AAG9B;IADC,IAAA,mBAAS,EAAC,GAAG,EAAE,CAAC,sCAAgB,EAAE,CAAC,WAAW,EAAE,EAAE,CAAC,WAAW,CAAC,QAAQ,CAAC;;mDACxC;AAGjC;IADC,IAAA,mBAAS,EAAC,GAAG,EAAE,CAAC,8BAAY,EAAE,CAAC,OAAO,EAAE,EAAE,CAAC,OAAO,CAAC,QAAQ,CAAC;;+CACpC;AAGzB;IADC,IAAA,kBAAQ,EAAC,GAAG,EAAE,CAAC,2BAAc,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC;8BAC7C,2BAAc;gDAAC;AAG1B;IADC,IAAA,kBAAQ,EAAC,GAAG,EAAE,CAAC,4BAAe,EAAE,CAAC,IAAI,EAAE,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC;8BAC7C,4BAAe;iDAAC;wBAtDjB,aAAa;IAHzB,IAAA,gBAAM,EAAC,gBAAgB,CAAC;IACxB,IAAA,gBAAM,EAAC,CAAC,aAAa,EAAE,UAAU,CAAC,CAAC;IACnC,IAAA,gBAAM,EAAC,CAAC,aAAa,EAAE,UAAU,EAAE,KAAK,CAAC,CAAC;GAC9B,aAAa,CAuDzB","sourcesContent":["import {BaseEntity, Column, Entity, OneToMany, OneToOne, PrimaryColumn, Unique,} from 'typeorm';\nimport {AuthConfigType, AuthTokenMethodEnum} from '../utils/types';\nimport {AccessTokenModel} from './access_token.entity';\nimport {IdTokenModel} from './id_token.entity';\nimport {PrivateKeyModel, PublicKeyModel} from './key.entity';\n\n@Entity('platform_model')\n@Unique(['platformUrl', 'clientId'])\n@Unique(['platformUrl', 'clientId', 'kid'])\nexport class PlatformModel extends BaseEntity {\n  @PrimaryColumn({ type: 'text' })\n  kid: string;\n\n  @Column({ type: 'text' })\n  platformUrl: string;\n\n  @Column({ type: 'text' })\n  clientId: string;\n\n  @Column({ type: 'text' })\n  name: string;\n\n  @Column({ type: 'text' })\n  authenticationEndpoint: string;\n\n  @Column({ type: 'text' })\n  accessTokenEndpoint: string;\n\n  @Column({ type: 'text', nullable: true })\n  authorizationServer?: string;\n\n  @Column({ type: 'enum', enum: AuthTokenMethodEnum, default: 'JWK_SET' })\n  authTokenMethod: AuthTokenMethodEnum;\n\n  @Column({ type: 'text' })\n  authTokenKey: string;\n\n  authToken(): AuthConfigType {\n    return {\n      method: this.authTokenMethod,\n      key: this.authTokenKey,\n    };\n  }\n\n  @Column({ type: 'boolean', default: false })\n  active: boolean;\n\n  @Column({ type: 'boolean', default: false })\n  dynamicallyRegistered: boolean;\n\n  @Column({ type: 'text', nullable: true })\n  registrationEndpoint?: string;\n\n  @OneToMany(() => AccessTokenModel, (accessToken) => accessToken.platform)\n  accessTokens: AccessTokenModel[];\n\n  @OneToMany(() => IdTokenModel, (idToken) => idToken.platform)\n  idTokens: IdTokenModel[];\n\n  @OneToOne(() => PublicKeyModel, (pubk) => pubk.platform)\n  publicKey: PublicKeyModel;\n\n  @OneToOne(() => PrivateKeyModel, (prvk) => prvk.platform)\n  privateKey: PrivateKeyModel;\n}\n"]}