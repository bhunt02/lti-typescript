<html><head><style>
html {
    box-sizing: border-box
}

body {
  padding: 2rem;
}

*,*:before,*:after {
    box-sizing: inherit
}

/* Extract from normalize.css by Nicolas Gallagher and Jonathan Neal git.io/normalize */
html {
    -ms-text-size-adjust: 100%;
    -webkit-text-size-adjust: 100%
}

body {
    margin: 0
}

article,aside,details,figcaption,figure,footer,header,main,menu,nav,section {
    display: block
}

summary {
    display: list-item
}

audio,canvas,progress,video {
    display: inline-block
}

progress {
    vertical-align: baseline
}

audio:not([controls]) {
    display: none;
    height: 0
}

[hidden],template {
    display: none
}

a {
    background-color: transparent
}

a:active,a:hover {
    outline-width: 0
}

abbr[title] {
    border-bottom: none;
    text-decoration: underline;
    text-decoration: underline dotted
}

b,strong {
    font-weight: bolder
}

dfn {
    font-style: italic
}

mark {
    background: #ff0;
    color: #000
}

small {
    font-size: 80%
}

sub,sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline
}

sub {
    bottom: -0.25em
}

sup {
    top: -0.5em
}

figure {
    margin: 1em 40px
}

img {
    border-style: none
}

code,kbd,pre,samp {
    font-family: monospace,monospace;
    font-size: 1em
}

hr {
    box-sizing: content-box;
    height: 0;
    overflow: visible
}

button,input,select,textarea,optgroup {
    font: inherit;
    margin: 0
}

optgroup {
    font-weight: bold
}

button,input {
    overflow: visible
}

button,select {
    text-transform: none
}

button,[type=button],[type=reset],[type=submit] {
    -webkit-appearance: button
}

button::-moz-focus-inner,[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner {
    border-style: none;
    padding: 0
}

button:-moz-focusring,[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring {
    outline: 1px dotted ButtonText
}

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: .35em .625em .75em
}

legend {
    color: inherit;
    display: table;
    max-width: 100%;
    padding: 0;
    white-space: normal
}

textarea {
    overflow: auto
}

[type=checkbox],[type=radio] {
    padding: 0
}

[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button {
    height: auto
}

[type=search] {
    -webkit-appearance: textfield;
    outline-offset: -2px
}

[type=search]::-webkit-search-decoration {
    -webkit-appearance: none
}

::-webkit-file-upload-button {
    -webkit-appearance: button;
    font: inherit
}

/* End extract */
html,body {
    font-family: Verdana,sans-serif;
    font-size: 15px;
    line-height: 1.5
}

html {
    overflow-x: hidden
}

h1 {
    font-size: 36px
}

h2 {
    font-size: 30px
}

h3 {
    font-size: 24px
}

h4 {
    font-size: 20px
}

h5 {
    font-size: 18px
}

h6 {
    font-size: 16px
}

.breadcrumb {
  padding: 0 0.5rem;
}

.breadcrumb ol {
  display: flex;
  flex-wrap: wrap;
  list-style: none;
  margin: 0;
  padding: 0;
  gap: 1rem;
  align-items: end;
}
</style><title>Names and Roles Provisioning Service Class Documentation</title></head><nav aria-label="Breadcrumb" class="breadcrumb"><ol><li><a href="/out/README.html">README</a></li><li><a href="/out/docs/Deep Linking.html">Deep Linking</a></li><li><a href="/out/docs/Dynamic Registration.html">Dynamic Registration</a></li><li><a href="/out/docs/Grading.html">Grading</a></li><li><a href="/out/docs/Introduction.html">Introduction</a></li><li><span aria-current="page">Names and Roles</span></li><li><a href="/out/docs/Platform.html">Platform</a></li><li><a href="/out/docs/Redirection URIs.html">Redirection URIs</a></li><li><a href="/out/docs/Table of Contents.html">Table of Contents</a></li></ol></nav><body><h1 id="namesandrolesprovisioningserviceclassdocumentation">Names and Roles Provisioning Service Class Documentation</h1>
<h2 id="tableofcontents">Table of Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#documentation">Documentation</a></li>
<li><a href="#license">License</a></li>
</ul>
<hr>
<h2 id="introduction">Introduction</h2>
<p>LTI-Typescript implements the <a href="https://www.imsglobal.org/spec/lti-nrps/v2p0">LTI&#174; 1.3 Names and Roles Provisioning Service</a> in the form of the <strong>NamesAndRolesService Class</strong>.</p>
<p>The Names And Roles Provisioning Service can be used by a tool to access a list of platform's users (referred to as members) and their roles within the context of a course, program or other grouping.</p>
<p>This class provides a single method for retrieving membership information, and offers the specified filters and functionalities.</p>
<hr>
<h2 id="usage">Usage</h2>
<h4 id="retrievingmembersfromaplatform">Retrieving members from a platform</h4>
<p>All members of a platform within the context can be retrieved simply by calling the <code class="prettyprint">getMembers()</code> method:</p>
<blockquote>
  <p><strong>Since the information necessary to make a request is present in the idtoken, it is necessary to pass it along as the first parameter.</strong></p>
</blockquote>
<pre class="prettyprint linenums"><code class="typescript language-typescript">const response = await provider.NamesAndRoles.getMembers(res.locals.token) // Gets context members
</code></pre>
<p>`</p>
<h5 id="examplestandardresponse">Example Standard Response</h5>
<pre class="prettyprint linenums"><code class="json5 language-json5">{
  "id" : "https://lms.example.com/sections/2923/memberships",
  "context": {
    "id": "2923-abc",
    "label": "CPS 435",
    "title": "CPS 435 Learning Analytics",
  },
  "members" : [
    {
      "status" : "Active",
      "name": "Jane Q. Public",
      "picture" : "https://platform.example.edu/jane.jpg",
      "given_name" : "Jane",
      "family_name" : "Doe",
      "middle_name" : "Marie",
      "email": "jane@platform.example.edu",
      "user_id" : "0ae836b9-7fc9-4060-006f-27b2066ac545",
      "lis_person_sourcedid": "59254-6782-12ab",
      "roles": [
        "http://purl.imsglobal.org/vocab/lis/v2/membership#Instructor"
      ]
    }
  ]
}
</code></pre>
<h4 id="addingfilters">Adding filters</h4>
<p>The <code class="prettyprint">getMembers()</code> method allows us to apply filters to the request, and these filters can be specified through the <code class="prettyprint">options</code> parameter:</p>
<ul>
<li><p> <code class="prettyprint">options.role</code></p>
<p>Specifies that only members part of a certain role should be included in the list.</p>
<p><strong>Example</strong>: </p></li>
</ul>
<pre class="prettyprint linenums"><code class="typescript language-typescript">  const members = await provider.NamesAndRolesService.getMembers(res.locals.token, { role: 'Learner' })
</code></pre>
<ul>
<li><p> <code class="prettyprint">options.limit</code></p>
<p>Specifies the number of members per page that should be returned per members page.</p>
<p>(<em>By default only one members page is returned.</em>)</p></li>
<li><p> <code class="prettyprint">options.pages</code></p>
<p>Specifies the number of pages that should be returned. <em>Defaults to 1</em>. If set to false, retrieves every available page.</p>
<p><strong>Example:</strong></p>
<p>(<em>The code below will return up to 20 members</em>)</p></li>
</ul>
<pre class="prettyprint linenums"><code class="typescript language-typescript">  const result = await provider.NamesAndRolesService.getMembers(res.locals.token, { role: 'Learner', limit: 10, pages: 2 })
</code></pre>
<ul>
<li><p> <code class="prettyprint">options.resourceLinkId</code></p>
<p>Accesses the Platform's Resource Link level membership service. This parameter will only take effect if the current context has a <code class="prettyprint">resourceLinkId</code>.</p></li>
</ul>
<pre class="prettyprint linenums"><code class="typescript language-typescript">  const result = await provider.NamesAndRolesService.getMembers(res.locals.token, { resourceLinkId: true, role: 'Learner', limit: 10, pages: 2 })
</code></pre>
<ul>
<li><p> <code class="prettyprint">options.url</code> </p>
<p>In case not all members were retrieved when the page limit was reached, the returned object will contain a <code class="prettyprint">next</code> field holding an url that can be used to retrieve the remaining members. </p>
<p>This url can be passed through the <code class="prettyprint">options.url</code> parameter. </p>
<p>(<em>If the <code class="prettyprint">options.url</code> parameter is present, the <code class="prettyprint">limit</code>, <code class="prettyprint">role</code> and <code class="prettyprint">resourceLinkId</code> filters are ignored, instead, the filters applied on the initial request will be maintained</em>)</p>
<p>Example:</p></li>
</ul>
<pre class="prettyprint linenums"><code class="json5 language-json5">  {
    "id" : "https://lms.example.com/sections/2923/memberships",
    "context": {
      "id": "2923-abc",
      "label": "CPS 435",
      "title": "CPS 435 Learning Analytics",
    },
    "members" : [
      ...
    ],
    "next": "https://lms.example.com/sections/2923/memberships/page/2"
  }
</code></pre>
<pre class="prettyprint linenums"><code class="typescript language-typescript">  const result = await provider.NamesAndRolesService.getMembers(res.locals.token, { role: 'Learner', limit: 10, pages: 2 })
  const next = result.next
  const remaining = await provider.NamesAndRolesService.getMembers(res.locals.token, { pages: 2, url: next }) // This request will maintain the "limit" and "role" parameters of the initial request
</code></pre>
<p>The same behaviour can be applied to the <a href="https://www.imsglobal.org/spec/lti-nrps/v2p0#membership-differences">differences url</a>, if it is present in the response:</p>
<p>Example:</p>
<pre class="prettyprint linenums"><code class="json5 language-json5">  {
    "id" : "https://lms.example.com/sections/2923/memberships",
    "context": {
      "id": "2923-abc",
      "label": "CPS 435",
      "title": "CPS 435 Learning Analytics",
    },
    "members" : [
      ...
    ],
    "differences": "https://lms.example.com/sections/2923/memberships?since=672638723"
  }
</code></pre>
<pre class="prettyprint linenums"><code class="typescript language-typescript">  const result = await provider.NamesAndRolesService.getMembers(res.locals.token, { role: 'Learner', limit: 10, pages: 2 })
  const differencesUrl = result.differences
  const differences = await provider.NamesAndRolesService.getMembers(res.locals.token, { url: differencesUrl })
</code></pre>
<hr>
<h3 id="examplebasicusage">Example Basic Usage</h3>
<pre class="prettyprint linenums"><code class="typescript language-typescript">// Members route
provider.app.get('/members', async (req, res) =&gt; {
  const members = await provider.NamesAndRolesService.getMembers(res.locals.token) // Gets context members
  res.send(members)
});
</code></pre>
<hr>
<h2 id="documentation">Documentation</h2>
<h4 id="namesandrolesservicegetmembersidtokenidtokenoptionsrolestringlimitnumberpagesnumberurlstringresourcelinkidbooleanpages1resourcelinkidfalsepromise60memberreturntype62">NamesAndRolesService.getMembers(idToken: IdToken, options?: { role?: string; limit?: number; pages?: number; url?: string; resourceLinkId?: boolean; } = { pages: 1, resourceLinkId: false }): Promise&lt;MemberReturnType[]&gt;</h4>
<p>Retrieves members from platform.</p>
<hr>
<h2 id="license">License</h2>
<blockquote>
  <p><a href="../LICENSE">APACHE2 License</a></p>
  <p><em>Learning Tools Interoperability&#174; (LTI&#174;) is a trademark of the IMS Global Learning Consortium, Inc. (https://www.imsglobal.org)</em></p>
  <p><em>This library is a derivative work of <a href="https://github.com/Cvmcosta">CVM Costa</a>'s original <a href="https://github.com/Cvmcosta/ltijs">LTIJS library</a>.</em> </p>
</blockquote></body></html>